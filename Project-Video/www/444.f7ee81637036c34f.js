"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[444],{444:(A,h,i)=>{i.r(h),i.d(h,{Tab2PageModule:()=>M});var l=i(8413),m=i(1320),p=i(5768),y=i(4206),d=i(7036),g=i(6308);class f{constructor(n){this.currentHealthBehavior=new g.X(n.currentHealth),this.dead=new g.X(!1),Object.assign(this,n),this.currentHealth=this.currentHealthBehavior.value,this.currentHealthBehavior.subscribe(t=>{this.currentHealth=this.currentHealthBehavior.value,t<=0?!0!==this.dead.value&&this.dead.next(!0):this.dead.next(!1)})}damage(n){this.currentHealthBehavior.next(this.currentHealthBehavior.value-n)}getEnemyHealthPercentage(){return this.currentHealthBehavior.value/this.maxHealth}}var o,e=i(3363),b=i(6104),u=i(4254),v=i(3575),T=i(7127);class s{constructor(n){this.dbServic=n,o.set(this,[]),(0,u.Q_)(this,o,"f").push({name:"goblin",id:1,maxHealth:10,currentHealth:10,defense:2,attack:2,speed:3,treadLevel:1,exsperienceGain:30,lootTable:v.i.commen}),(0,u.Q_)(this,o,"f").push({name:"kobold",id:2,maxHealth:15,currentHealth:15,defense:1,attack:3,speed:4,treadLevel:1,exsperienceGain:40,lootTable:v.i.uncommen}),(0,u.Q_)(this,o,"f").push({name:"bandit",id:3,maxHealth:50,currentHealth:50,defense:7,attack:5,speed:0,treadLevel:2,exsperienceGain:100,lootTable:v.i.uncommen})}getEnemyByName(n){return(0,u.Q_)(this,o,"f").find(t=>t.name===n)}findEnemyByTreadLevel(n){var t=this;return(0,d.Z)(function*(){try{return yield t.dbServic.retrieveEnemyByTreatlevel("enemys",n)}catch{console.log("error in find enemy by treat level")}})()}}o=new WeakMap,s.\u0275fac=function(n){return new(n||s)(e.LFG(T.k))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"});var E=i(3042);function P(a,n){if(1&a&&(e.TgZ(0,"div")(1,"p"),e._uU(2),e.qZA(),e._UZ(3,"ion-progress-bar",7),e.qZA()),2&a){const t=e.oxw();e.xp6(2),e.lnq(" ",t.activeEnemy.name,": ",t.activeEnemy.maxHealth,"/",t.activeEnemy.currentHealth," "),e.xp6(1),e.Q6J("value",t.activeEnemy.getEnemyHealthPercentage())}}function H(a,n){if(1&a){const t=e.EpF();e.TgZ(0,"ion-button",8),e.NdJ("click",function(){e.CHM(t);const c=e.oxw();return e.KtG(c.attack())}),e._uU(1,"damage"),e.qZA()}}function x(a,n){1&a&&(e.TgZ(0,"p"),e._uU(1," you won"),e.qZA())}function S(a,n){if(1&a){const t=e.EpF();e.TgZ(0,"ion-button",8),e.NdJ("click",function(){e.CHM(t);const c=e.oxw();return e.KtG(c.newBattle())}),e._uU(1,"New Battle"),e.qZA()}}const B=[{path:"",component:(()=>{class a{constructor(t,r,c){this.playerService=t,this.enemyService=r,this.itemService=c,this.newBattle()}setEnemyListeners(){console.log(this.activeEnemy),this.subscrition=this.activeEnemy.dead.subscribe(t=>{!0===t&&(this.playerService.givePlayerBattleExperience(this.activeEnemy.exsperienceGain),this.playerService.givePlayerItem(this.itemService.getRandomEquipmentOfRarity(this.activeEnemy.lootTable)))})}attack(){this.activeEnemy.damage(this.playerService.getPlayerCurrentAttack()),this.playerService.playerDamage(this.activeEnemy.attack)}newBattle(){var t=this;return(0,d.Z)(function*(){try{console.log(t.activeEnemy),void 0!==t.activeEnemy&&t.subscrition.unsubscribe();const r=yield t.enemyService.findEnemyByTreadLevel(t.playerService.getPlayerLevel()),c=r.length;t.activeEnemy=new f(r[Math.floor(Math.random()*c)]),t.setEnemyListeners(),t.playerService.healPlayer(t.playerService.getPlayerMaxHealth()-t.playerService.getPlayerCurrentHealth())}catch{console.log("error in new battle")}})()}}return a.\u0275fac=function(t){return new(t||a)(e.Y36(b.l),e.Y36(s),e.Y36(E.e))},a.\u0275cmp=e.Xpm({type:a,selectors:[["app-tab2"]],decls:17,vars:10,consts:[[3,"translucent"],[3,"fullscreen"],["collapse","condense"],["size","large"],[4,"ngIf"],["color","success",3,"value"],[3,"click",4,"ngIf"],["color","danger",3,"value"],[3,"click"]],template:function(t,r){1&t&&(e.TgZ(0,"ion-header",0)(1,"ion-toolbar")(2,"ion-title"),e._uU(3," Batlle "),e.qZA()()(),e.TgZ(4,"ion-content",1)(5,"ion-header",2)(6,"ion-toolbar")(7,"ion-title",3),e._uU(8,"Tab 2"),e.qZA()()(),e.YNc(9,P,4,4,"div",4),e.TgZ(10,"div")(11,"p"),e._uU(12),e.qZA(),e._UZ(13,"ion-progress-bar",5),e.YNc(14,H,2,0,"ion-button",6),e.qZA(),e.YNc(15,x,2,0,"p",4),e.YNc(16,S,2,0,"ion-button",6),e.qZA()),2&t&&(e.Q6J("translucent",!0),e.xp6(4),e.Q6J("fullscreen",!0),e.xp6(5),e.Q6J("ngIf",!1===r.activeEnemy.dead.value),e.xp6(3),e.lnq(" ",r.playerService.getPlayerName(),": ",r.playerService.getPlayerMaxHealth(),"/",r.playerService.getPlayerCurrentHealth()," "),e.xp6(1),e.Q6J("value",r.playerService.getPlayerHealthPercentage()),e.xp6(1),e.Q6J("ngIf",!1===r.activeEnemy.dead.value),e.xp6(1),e.Q6J("ngIf",r.activeEnemy.dead.value),e.xp6(1),e.Q6J("ngIf",r.activeEnemy.dead.value))},dependencies:[l.YG,l.W2,l.Gu,l.X7,l.wd,l.sr,m.O5]}),a})()}];let Z=(()=>{class a{}return a.\u0275fac=function(t){return new(t||a)},a.\u0275mod=e.oAB({type:a}),a.\u0275inj=e.cJS({imports:[y.Bz.forChild(B),y.Bz]}),a})(),M=(()=>{class a{}return a.\u0275fac=function(t){return new(t||a)},a.\u0275mod=e.oAB({type:a}),a.\u0275inj=e.cJS({imports:[l.Pc,m.ez,p.u5,Z]}),a})()}}]);